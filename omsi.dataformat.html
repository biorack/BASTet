

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dataformat Package &mdash; BASTet: Berkeley Analysis and Storage Toolkit Documentation 2.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="BASTet: Berkeley Analysis and Storage Toolkit Documentation 2.0.0 documentation" href="index.html"/>
        <link rel="up" title="omsi Package" href="omsi.html"/>
        <link rel="next" title="OMSI Dataformat Package" href="omsi.dataformat.omsi_file.html"/>
        <link rel="prev" title="compound_stats Package" href="omsi.analysis.compound_stats.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> BASTet: Berkeley Analysis and Storage Toolkit Documentation
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="convert_files.html">Converting and Files and Making them Accessible</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_filereader.html">Integrating new file formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_analysis.html">Developing a new Analysis for BASTet</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_workflows.html">Defining and Executing Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_workflows.html#workflow-tools">Workflow Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="HDF5_format.html">OMSI Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="HDF5_format_performance.html">HDF5 I/O Performance</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="omsi.html">omsi Package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="omsi.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="omsi.analysis.html">analysis Package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">dataformat Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="omsi.dataformat.omsi_file.html">OMSI Dataformat Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-omsi.dataformat.file_reader_base"><code class="docutils literal"><span class="pre">file_reader_base</span></code> Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-omsi.dataformat.img_file"><code class="docutils literal"><span class="pre">img_file</span></code> Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mzml-file-module"><code class="docutils literal"><span class="pre">mzml_file</span></code> Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-omsi.dataformat.bruckerflex_file"><code class="docutils literal"><span class="pre">bruckerflex_file</span></code> Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="omsi.datastructures.html">datastructures Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="omsi.shared.html">shared Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="omsi.workflow.html">workflow Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="omsi.tools.html">tools Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="omsi.examples.html">examples Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="omsi.templates.html">templates Package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">BASTet: Berkeley Analysis and Storage Toolkit Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="omsi.html">omsi Package</a> &raquo;</li>
      
    <li>dataformat Package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/omsi.dataformat.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dataformat-package">
<h1>dataformat Package<a class="headerlink" href="#dataformat-package" title="Permalink to this headline">¶</a></h1>
<p>Main module for specification of data formats. This module also contains the
<cite>omsi_file</cite> module which specifies the OpenMSI HDF5 data format. In addition
it defines the base class for third-party file readers (i.e, <cite>file_reader_base</cite>)
and implements various basic file readers for third-party formats, e.g,
<cite>img_file</cite> and <cite>mzml_file</cite> for IMG and MZML data files respectively (among others).</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file" title="omsi.dataformat.omsi_file"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file</span></code></a></td>
<td>Module for specification of the OpenMSI file API.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.analysis" title="omsi.dataformat.omsi_file.analysis"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.analysis</span></code></a></td>
<td>Module for managing custom analysis data in OMSI HDF5 files.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.common" title="omsi.dataformat.omsi_file.common"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.common</span></code></a></td>
<td>Module for common data format classes and functionality.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.dependencies" title="omsi.dataformat.omsi_file.dependencies"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.dependencies</span></code></a></td>
<td>Base module for managing of dependencies between data in OpenMSI HDF5 files</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.experiment" title="omsi.dataformat.omsi_file.experiment"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.experiment</span></code></a></td>
<td>OMSI file module for management of experiment data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.format" title="omsi.dataformat.omsi_file.format"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.format</span></code></a></td>
<td>This module defines the basic format for storing mass spectrometry imaging data, metadata, and analysis in HDF5 in compliance with OpenMSI file format.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.instrument" title="omsi.dataformat.omsi_file.instrument"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.instrument</span></code></a></td>
<td>Module for managing instrument related data in OMSI files.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.main_file" title="omsi.dataformat.omsi_file.main_file"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.main_file</span></code></a></td>
<td>Module for managing OpenMSI HDF5 data files.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.metadata_collection" title="omsi.dataformat.omsi_file.metadata_collection"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.metadata_collection</span></code></a></td>
<td>Module for management of general metadata storage entities.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.methods" title="omsi.dataformat.omsi_file.methods"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.methods</span></code></a></td>
<td>Module for management of method specific data in OMSI data files</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.msidata" title="omsi.dataformat.omsi_file.msidata"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.omsi_file.msidata</span></code></a></td>
<td>Module for managing MSI data in OMSI data files</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#module-omsi.dataformat.file_reader_base" title="omsi.dataformat.file_reader_base"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.file_reader_base</span></code></a></td>
<td>Module for base classes for implementation and integration of third-party file readers.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#module-omsi.dataformat.bruckerflex_file" title="omsi.dataformat.bruckerflex_file"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.bruckerflex_file</span></code></a></td>
<td>This module provides functionality for reading bruker flex mass spectrometry image files</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#module-omsi.dataformat.img_file" title="omsi.dataformat.img_file"><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.img_file</span></code></a></td>
<td>This module provides functionality for reading img mass spectrometry image files</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.imzml_file</span></code></td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">omsi.dataformat.mzml_file</span></code></td>
<td></td>
</tr>
</tbody>
</table>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="omsi.dataformat.omsi_file.html">OMSI Dataformat Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file"><code class="docutils literal"><span class="pre">omsi_file</span></code> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.format"><code class="docutils literal"><span class="pre">format</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.common"><code class="docutils literal"><span class="pre">common</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.main_file"><code class="docutils literal"><span class="pre">main_file</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.experiment"><code class="docutils literal"><span class="pre">experiment</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.metadata_collection"><code class="docutils literal"><span class="pre">metadata_collection</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.instrument"><code class="docutils literal"><span class="pre">instrument</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.methods"><code class="docutils literal"><span class="pre">methods</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.msidata"><code class="docutils literal"><span class="pre">msidata</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.analysis"><code class="docutils literal"><span class="pre">analysis</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omsi.dataformat.omsi_file.html#module-omsi.dataformat.omsi_file.dependencies"><code class="docutils literal"><span class="pre">dependencies</span></code> Module</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-omsi.dataformat.file_reader_base">
<span id="file-reader-base-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">file_reader_base</span></code> Module<a class="headerlink" href="#module-omsi.dataformat.file_reader_base" title="Permalink to this headline">¶</a></h2>
<p>Module for base classes for implementation and integration of third-party file readers.</p>
<p>ToDo:</p>
<ul class="simple">
<li>get_number_of_regions(...) should be updated to return a list of regions, one per dataset</li>
<li>Need to add base class for multi dataset formats</li>
<li>Need to add base class for multi dataset+region formats</li>
<li>Need to implement new file format for combined raw data file (ie., multiple raw files in one folder).</li>
</ul>
<dl class="class">
<dt id="omsi.dataformat.file_reader_base.file_reader_base">
<em class="property">class </em><code class="descclassname">omsi.dataformat.file_reader_base.</code><code class="descname">file_reader_base</code><span class="sig-paren">(</span><em>basename</em>, <em>requires_slicing=True</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base-class used to define the basic interface that file-readers
for a new format need to implement.</p>
<p><strong>__init__ interface:</strong></p>
<p>To avoid the need for custom code subclasses should be able to be constructed     by providing just the basename parameter and optional requires_slicing parameter.     If additional inputs are needed, then file conversion and management scripts     may need to be modified to account for the custom requirements. 
<strong>Required Attributes:</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_type</strong> &#8211; String indicating the data type to be used (e.g., uint16)</li>
<li><strong>shape</strong> &#8211; Tuple indicating the shape of the data</li>
<li><strong>mz</strong> &#8211; Numpy array with the m/z axis data. In the case of multi-data this is a
list of numpy arrays, one per dataset.</li>
<li><strong>basename</strong> &#8211; The basename provided for opening the file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Required Interface Functions:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">close_file</span></code> : Close any opened files</li>
<li><code class="docutils literal"><span class="pre">is_valid_dataset</span></code> : Check whether a given dir/file is valid under the current format</li>
<li><code class="docutils literal"><span class="pre">spectrum_iter</span></code> : Generator function that iterates over all the spectra in the current data cube and yield the         numpy array with the intensity and integer x, y position of the spectrum</li>
</ul>
<p><strong>Optional Interface Functions:</strong></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">__getitem__</span></code> <span class="classifier-delimiter">:</span> <span class="classifier">Implement array slicing for files. Reuqired if the requires_slicing parameter</span></dt>
<dd><p class="first last">should be supported.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">supports_regions</span></code> : Specify whether the format supports multiple regions (default=False)</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">supports_multidata</span></code>: Specify whether the format supports multiple datasets (default=False)</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">supports_multiexperiment</span></code>: Specify whether the format supports multiple experiments (default=False)</p>
</li>
</ul>
<p>Construct the base class and define required attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>basename</strong> &#8211; The name of the file or directory with the file to be opened by the reader</li>
<li><strong>requires_slicing</strong> &#8211; Boolean indicating whether the user requires array slicing via
the __getitem__ function to work or not. This is an optimization, because many MSI
data formats do not easily support arbitrary slicing of data but rather only
iteration over spectra.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="staticmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.available_formats">
<em class="property">static </em><code class="descname">available_formats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.available_formats" title="Permalink to this definition">¶</a></dt>
<dd><p>Get dictionary of all available file formats that implement the file_format_base API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary where the keys are the names of the formats and the values are
the corresponding file reader classes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.close_file">
<code class="descname">close_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.close_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the file.</p>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.format_name">
<em class="property">classmethod </em><code class="descname">format_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.format_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the name of the format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">String indicating the name of the format.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.get_dataset_metadata">
<code class="descname">get_dataset_metadata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.get_dataset_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Get dict of additional metadata associated with the current dataset</p>
<p>NOTE: In the case that multiple regions and/or datasets are supported,
this function should return the metadata of the currently selected
dataset only. If no particular dataset is selected, then all should
be returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Instance of omsi.shared.metadata_data.metadata_dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.get_number_of_datasets">
<code class="descname">get_number_of_datasets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.get_number_of_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>File readers with multi dataset support must overwrite this function
to retrieve the true number of raw datasets in the file.
Default implementation returns 1.</p>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.get_number_of_regions">
<code class="descname">get_number_of_regions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.get_number_of_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>File readers with multi region support must overwrite this function
to retrieve the true number of regions in the file.
Default implementation returns 1.</p>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.is_valid_dataset">
<em class="property">classmethod </em><code class="descname">is_valid_dataset</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.is_valid_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Classmethod used to check whether a given directory (or file)
defines as valid data file of the file format specified by
the current child class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>String</em>) &#8211; Name of the dir or file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Boolean indicating whether the given file or folder is a valid file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.size">
<em class="property">classmethod </em><code class="descname">size</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Classmethod used to check the estimated size for the given file/folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>String</em>) &#8211; Name of the dir or file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Integer indicating the size in byte or None if unknown.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.spectrum_iter">
<code class="descname">spectrum_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.spectrum_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable iteration of the spectra of the current data cube.</p>
<p>Iterate over all the spectra in the current data cube and yield the
numpy array with the intensity and integer x, y position of the spectrum.</p>
<p>NOTE: As this is a generator one needs to use yield.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The function yields for each spectrum the following information:<ul class="simple">
<li>tuple of (x,y) or (x,y,z) position of the spectrum</li>
<li>Numpy array with the spectrum</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.supports_multidata">
<em class="property">classmethod </em><code class="descname">supports_multidata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.supports_multidata" title="Permalink to this definition">¶</a></dt>
<dd><p>Define whether the file format support multiple independent datasets.</p>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.supports_multiexperiment">
<em class="property">classmethod </em><code class="descname">supports_multiexperiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.supports_multiexperiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Define whether the file format supports multiple independent experiments,
each of which may contain multiple datasets.</p>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base.supports_regions">
<em class="property">classmethod </em><code class="descname">supports_regions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base.supports_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Define whether the file format support multiple regions.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_multidata">
<em class="property">class </em><code class="descclassname">omsi.dataformat.file_reader_base.</code><code class="descname">file_reader_base_multidata</code><span class="sig-paren">(</span><em>basename</em>, <em>requires_slicing</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_multidata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#omsi.dataformat.file_reader_base.file_reader_base" title="omsi.dataformat.file_reader_base.file_reader_base"><code class="xref py py-class docutils literal"><span class="pre">omsi.dataformat.file_reader_base.file_reader_base</span></code></a></p>
<p>Base-class used to define the basic interface for file-readers
used to implement new file formats with support for multiple
dataset (e.g, MSI dataset with multiple spectrum types).
This class extends file_reader_base, and accordingly all
required attributes and functions of
file_reader_base must be implemented by subclasses.</p>
<p>In addition to the file_reader_base functions we need to implement
the get_number_of_datasets(...) and get_dataset_dependencies(...)
functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><strong>select_dataset</strong> &#8211; Unsigned integer indicating the currently selected dataset</td>
</tr>
</tbody>
</table>
<p>Construct the base class and define required attributes.</p>
<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_multidata.get_dataset_dependencies">
<code class="descname">get_dataset_dependencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_multidata.get_dataset_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dependencies between the current dataset and any of the
other datasets stored in the current file. If self.select_dataset
is not set, then the function is expected to return a list of lists
with all dependencies for all datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of dependencies (or list of lists of dependencies if self.select_dataset is None)
where each dependency is a dict of the following form:<ul class="simple">
<li>&#8216;omsi_object&#8217;: None,         # The omsi file API object where the data is stored. Often None.</li>
<li>&#8216;link_name&#8217;: ms2_link_name,  # Name for the dependency link to be used</li>
<li>&#8216;basename&#8217;: basename,        # Basename of the file</li>
<li>&#8216;region&#8217;: None,              # Index of the region in the dataset or None</li>
<li>&#8216;dataset&#8217;: ind2,             # Index of the dataset withing the file or None</li>
<li>&#8216;help&#8217;:scan_types[ms1scan],  # Help describing the depdency</li>
<li>dependency_type&#8217;: ... }     # Type of dependency see dependency_dict.dependency_type for available types</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_multidata.get_number_of_datasets">
<code class="descname">get_number_of_datasets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_multidata.get_number_of_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of available datasets.</p>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_multidata.set_dataset_selection">
<code class="descname">set_dataset_selection</code><span class="sig-paren">(</span><em>dataset_index</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_multidata.set_dataset_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the current dataset to be read.</p>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_multidata.supports_multidata">
<em class="property">classmethod </em><code class="descname">supports_multidata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_multidata.supports_multidata" title="Permalink to this definition">¶</a></dt>
<dd><p>Define whether the file format supports multiple data blocks.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_with_regions">
<em class="property">class </em><code class="descclassname">omsi.dataformat.file_reader_base.</code><code class="descname">file_reader_base_with_regions</code><span class="sig-paren">(</span><em>basename</em>, <em>requires_slicing</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#omsi.dataformat.file_reader_base.file_reader_base" title="omsi.dataformat.file_reader_base.file_reader_base"><code class="xref py py-class docutils literal"><span class="pre">omsi.dataformat.file_reader_base.file_reader_base</span></code></a></p>
<p>Base-class used to define the basic interface for file-readers
used to implement new file formats with support for multiple
imaging regions per file. This class extends file_reader_base,
and accordingly all required attributes and functions of
file_reader_base must be implemented by subclasses.</p>
<p><strong>Additional required attributes:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">select_region</span></code> : Integer indicating which region should be selected.                     If set to None, indicates that the data should be treated                     as a whole. If set to a region index, then the data should                     be treated by the reader as if it only pertains to that                     region, ie., the shape of the data should be set accordingly                     and __getitem__ should behave as such as well.</li>
<li><code class="docutils literal"><span class="pre">region_dicts</span></code> : List of dictionaries, where each dictionary describes a                     given region (e.g,. the origin and extend for rectangular                     regions.</li>
</ul>
<p>Construct the base class and define required attributes.</p>
<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_dataset_dependencies">
<code class="descname">get_dataset_dependencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_dataset_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dependencies between the current region and any of the
other region datasets stored in the current file. If self.select_region
is not set, then the function is expected to return a list of lists
with all dependencies for all datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of dependencies (or list of lists of dependencies if self.select_dataset is None)
where each dependency is a dict of the following form:<ul class="simple">
<li>&#8216;omsi_object&#8217;: None,         # The omsi file API object where the data is stored. Often None.</li>
<li>&#8216;link_name&#8217;: ms2_link_name,  # Name for the dependency link to be used</li>
<li>&#8216;basename&#8217;: basename,        # Basename of the file</li>
<li>&#8216;region&#8217;: None,              # Index of the region in the dataset or None</li>
<li>&#8216;dataset&#8217;: ind2,             # Index of the dataset withing the file or None</li>
<li>&#8216;help&#8217;:scan_types[ms1scan],  # Help describing the depdency</li>
<li>dependency_type&#8217;: ... }     # Type of dependency see dependency_dict.dependency_type for available types</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_number_of_regions">
<code class="descname">get_number_of_regions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_number_of_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of available regions</p>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_region_selection">
<code class="descname">get_region_selection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_region_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the index of the selected region</p>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_regions">
<code class="descname">get_regions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions.get_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of all region dictionaries defining for each region the origin
and extend of the region. See also self.region_dicts.</p>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_with_regions.set_region_selection">
<code class="descname">set_region_selection</code><span class="sig-paren">(</span><em>region_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions.set_region_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Define which region should be selected for local data reads.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>region_index</strong> &#8211; The index of the region that should be read. The shape of the
data will be adjusted accordingly. Set to None to select all regions and treat
the data as a single full 3D image.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.file_reader_base.file_reader_base_with_regions.supports_regions">
<em class="property">classmethod </em><code class="descname">supports_regions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions.supports_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>Define whether the file format support multiple regions.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-omsi.dataformat.img_file">
<span id="img-file-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">img_file</span></code> Module<a class="headerlink" href="#module-omsi.dataformat.img_file" title="Permalink to this headline">¶</a></h2>
<p>This module provides functionality for reading img mass spectrometry image files</p>
<dl class="class">
<dt id="omsi.dataformat.img_file.img_file">
<em class="property">class </em><code class="descclassname">omsi.dataformat.img_file.</code><code class="descname">img_file</code><span class="sig-paren">(</span><em>hdr_filename=None</em>, <em>t2m_filename=None</em>, <em>img_filename=None</em>, <em>basename=None</em>, <em>requires_slicing=True</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.img_file.img_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#omsi.dataformat.file_reader_base.file_reader_base" title="omsi.dataformat.file_reader_base.file_reader_base"><code class="xref py py-class docutils literal"><span class="pre">omsi.dataformat.file_reader_base.file_reader_base</span></code></a></p>
<p>Interface for reading a single 2D img file</p>
<p>The img format consists of three different files:
i) hdr header file, ii) t2m which contains the m/z data,
iii) img data file.</p>
<p>Open an img file for data reading.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hdr_filename</strong> (<em>string</em>) &#8211; The name of the hdr header file</li>
<li><strong>t2m_filename</strong> (<em>string</em>) &#8211; The name of the t2m_filename</li>
<li><strong>img_filename</strong> (<em>string</em>) &#8211; The name of the img data file</li>
<li><strong>basename</strong> (<em>string</em>) &#8211; Instead of img_filename, t2m_filename, and hdr_filename one may also supply just
a single basename. The basename is completed with the .img, .t2m, .hdr extension
to load the data.</li>
<li><strong>requires_slicing</strong> (<em>Boolean</em>) &#8211; Unused here. Slicing is always supported by this reader.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> &#8211; In case that basename and hdr_filename, t2m_filename, and img_filename are specified.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="omsi.dataformat.img_file.img_file.close_file">
<code class="descname">close_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.img_file.img_file.close_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the img file</p>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.img_file.img_file.get_files_from_dir">
<em class="property">classmethod </em><code class="descname">get_files_from_dir</code><span class="sig-paren">(</span><em>dirname</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.img_file.img_file.get_files_from_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of all basenames of all img files in a given directory.
Note: The basenames include the dirname.</p>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.img_file.img_file.is_valid_dataset">
<em class="property">classmethod </em><code class="descname">is_valid_dataset</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.img_file.img_file.is_valid_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the given file or directory points to a img file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>unicode</em>) &#8211; Name of the dir or file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Boolean indicating whether the given file or folder is a valid img file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.img_file.img_file.size">
<em class="property">classmethod </em><code class="descname">size</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.img_file.img_file.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Classmethod used to check the estimated size for the given file/folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>unicode</em>) &#8211; Name of the dir or file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Integer indicating the size in byte or None if unknown.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.img_file.img_file.spectrum_iter">
<code class="descname">spectrum_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.img_file.img_file.spectrum_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable iteration over the spectra in the file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple of ((x , y) , intensities), i.e., the tuple of (x, y) integer index of the spectrum and
the numpy array of the intensities</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mzml-file-module">
<h2><code class="xref py py-mod docutils literal"><span class="pre">mzml_file</span></code> Module<a class="headerlink" href="#mzml-file-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-omsi.dataformat.bruckerflex_file">
<span id="bruckerflex-file-module"></span><h2><code class="xref py py-mod docutils literal"><span class="pre">bruckerflex_file</span></code> Module<a class="headerlink" href="#module-omsi.dataformat.bruckerflex_file" title="Permalink to this headline">¶</a></h2>
<p>This module provides functionality for reading bruker flex mass spectrometry image files</p>
<p>Limitations:</p>
<ol class="arabic simple">
<li>Currently the reader assumes a single global m/z axis for all spectra.</li>
<li>The read of acqu files does not convert &lt;..&gt; entries to python values but leaves them as strings.</li>
<li>__read_spotlist__ converts the regions to start with a 0 index. This is somewhat inconsistent in the spot list file.  The spotname seems to number regions starting with 0 while the region list numbers them starting with 1.</li>
<li>__read_spotlist__ computes the folder where the spots are located based on the filename of the spotlist.    The question is whether this is always the case??? The advantage is that we do not rely on the regions.xml    file which contains absolute paths which are in most cases invalid as the data has been copied between different    machines in many cases and is stored in different locations on each of the machines.</li>
<li>__read_spotlist__ currenly assumes that there is only one fid file per spot</li>
<li>__read_spotlist__ currenlty only looks at where the acqu and fid file is located for the spot. Other files   are currently ignored.</li>
<li>__read_spotlist__ (and hence the reader at large) currently assumes that we have 2D images only.</li>
<li>__read_spotlist__ currently generates maps for the image that assume that x and y pixel indices start at    0. Not all images may record data until the border, so that this strategy may add empty spectra rather than    generating a new bounding box for the image.</li>
<li>__read_spotlist__ assumes in the variable spotname_encoding a maximum of 24 characters in the spotname    R01X080Y013. This should in general be more than sufficient as this allows for 7 characters for each R, X,    Y entry, however, if this is not enough then this behaviour needs ot be changed.</li>
<li>__getitem__ currently only works if we have read the full data into memory. An on-demand load should be supported     as well.</li>
<li>We can currently only selected either a single region or the full data but we cannot selected multiple regions     at once. E.g. if a dataset contains 3 regions then we can either select all regions at once or region 1,2, or 3     but one cannot selected region 1+2, 1+3, or 2+3.</li>
</ol>
<p>import bruckerflex_file
spotlist = &#8220;/Users/oruebel/Devel/msidata/Bruker_Data/UNC IMS Data/20130417 Bmycoides Paenibacillus Early SN03130/&#8221; +            &#8220;2013 Bmyc Paeni Early LP/2013 Bmyc Paeni Early LP Spot List.txt&#8221;
exppath =&#8221;/Users/oruebel/Devel/msidata/Bruker_Data/UNC IMS Data/20130417 Bmycoides Paenibacillus Early SN03130/&#8221; +         &#8220;2013 Bmyc Paeni Early LP/2013 Bmyc Paeni Early LP/0_R00X012Y006/1/1SLin&#8221;
f = bruckerflex_file.bruckerflex_file( spotlist_filename = spotlist)
f.s_read_fid( exppath+&#8221;/fid&#8221; , f.data_type )
testacqu = f.s_read_acqu( exppath+&#8221;/acqu&#8221; )
testmz   = f.s_mz_from_acqu( testacqu )
testspotlist = f.s_read_spotlist(spotlist)</p>
<p>a = bruckerflex_file( dirname )</p>
<dl class="class">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file">
<em class="property">class </em><code class="descclassname">omsi.dataformat.bruckerflex_file.</code><code class="descname">bruckerflex_file</code><span class="sig-paren">(</span><em>basename</em>, <em>fid_encoding='int32'</em>, <em>requires_slicing=True</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#omsi.dataformat.file_reader_base.file_reader_base_with_regions" title="omsi.dataformat.file_reader_base.file_reader_base_with_regions"><code class="xref py py-class docutils literal"><span class="pre">omsi.dataformat.file_reader_base.file_reader_base_with_regions</span></code></a></p>
<p>Interface for reading a single bruker flex image file.</p>
<p>The reader supports standard array slicing for data read. I.e., to read a
spectrum use [x,y,:] to read an ion image using [:,:,mz].</p>
<p>The reader supports multiple regions, i.e., reading of different independent
regions that were imaged as part of the same dataset. Using the get_regions, get_number_of_regions,
set_region_selection and get_region_selection the user can interact with the
region settings. Using the set_region_selection the user can define whether
the data of the complete image should be read (set_region(None), default) or
whether data from a single region should be read. When a region is selected,
then the reader acts as if the region were the complete dataset, i.e., the
shape variable is addjusted to fit the selected region and the __get_item__
method (which is used to implement array-like slicing (e.g., [1,1,:])) behaves
as if the selected region where the full data.</p>
<p>Open an img file for data reading.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>basename</strong> (<em>string</em>) &#8211; Name of the textfile with the spotlist. Alternatively this may also be the                                       folder with the spots.</li>
<li><strong>requires_slicing</strong> (<em>bool</em>) &#8211; Should the complete data be read into memory (this makes slicing easier). (default is True)</li>
<li><strong>fid_encoding</strong> (<em>string</em>) &#8211; String indicating in which binary format the intensity values (fid files) are stored.                                  (default value is &#8216;int32&#8217;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first simple">
<li><strong>self.basename</strong> &#8211; Name of the file with the spotlist</li>
<li><strong>self.pixel_dict</strong> &#8211; <p>dictionary with the pixel array metadata (see also s_read_spotlist(...)). Some of                  the main keys of the dictionary are, e.g. (see also s_read_spotlist(...)) :</p>
<ul>
<li>&#8216;spotfolder&#8217; : String indicating the folder where all the spot-data is located</li>
<li>&#8216;fid&#8217; : 2D numpy masked array of strings indicating for (x,y) pixel the fid file with                            the intensity values.</li>
<li>&#8216;acqu&#8217; : 2D numpy masked array of strings indicating for each (x,y) pixel the acqu file with the                            metadata for that pixel.</li>
<li>&#8216;regions&#8217; : 2D numpy masked array of integers indicating for each pixels the index of the region                            it belongs to.</li>
<li>&#8216;xpos&#8217; : 2D numpy masked array of integers indicated for each pixel its x position.</li>
<li>&#8216;ypos&#8217; : 2D numpy masked array of integers indicated for each pixel its x position.</li>
<li>&#8216;spotname&#8217; : 2D masked numpy array of strings with the names of the spot corresponding to a pixel.</li>
</ul>
</li>
<li><strong>self.data_type</strong> &#8211; the encoding used for intensity values</li>
<li><strong>self.shape</strong> &#8211; The 3D shape of the MSI data volume for the currently selected region.</li>
<li><strong>self.full_shape</strong> &#8211; Shape of the full 3D MSI dataset including all regions imaged.</li>
<li><strong>self.metadata</strong> &#8211; Dictionary with metadata from the acqu file</li>
<li><strong>self.mz</strong> &#8211; The 1D numpy array with the m/z axis information</li>
<li><strong>self.data</strong> &#8211; If requires_slicing is set to true then this 3D array includes the complete data of the MSI data                   cube. Missing data values (e.g., from regions not imaged during the aquistion processes) are                   completed with zero values.</li>
<li><strong>self.region_dicts</strong> &#8211; Dictionary with description of the imaging regions</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> &#8211; In case that no valid data is found.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.close_file">
<code class="descname">close_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.close_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the img file</p>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.get_dataset_dependencies">
<code class="descname">get_dataset_dependencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.get_dataset_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dependencies between the current region and any of the
other region datasets stored in the current file. If self.select_region
is not set, then the function is expected to return a list of lists
with all dependencies for all datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of dependencies (or list of lists of dependencies if self.select_dataset is None)
where each dependency is a dict of the following form:<ul class="simple">
<li>&#8216;omsi_object&#8217;: None,         # The omsi file API object where the data is stored. Often None.</li>
<li>&#8216;link_name&#8217;: ms2_link_name,  # Name for the dependency link to be used</li>
<li>&#8216;basename&#8217;: basename,        # Basename of the file</li>
<li>&#8216;region&#8217;: None,              # Index of the region in the dataset or None</li>
<li>&#8216;dataset&#8217;: ind2,             # Index of the dataset withing the file or None</li>
<li>&#8216;help&#8217;:scan_types[ms1scan],  # Help describing the depdency</li>
<li>dependency_type&#8217;: ... }     # Type of dependency see dependency_dict.dependency_type for available types</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.is_valid_dataset">
<em class="property">classmethod </em><code class="descname">is_valid_dataset</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.is_valid_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the given file or name specifies a bruckerflex file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>string</em>) &#8211; name of the file or dir</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Boolean indicating whether the name is a valid bruckerflex</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.s_mz_from_acqu">
<em class="property">static </em><code class="descname">s_mz_from_acqu</code><span class="sig-paren">(</span><em>acqu_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.s_mz_from_acqu" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the m/z axis from the data stored in the acqu_dict dictionary.
See also s_read_acqu</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>acqu_dict</strong> &#8211; <p>Python dictionary with the complete information from the acqu file. See s_read_acqu(...).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">returns:</th><td class="field-body">1D Numpy array of floats with the mz axis data.</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.s_read_acqu">
<em class="property">static </em><code class="descname">s_read_acqu</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.s_read_acqu" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an m/z axis for the given acqu file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) &#8211; String with the name+path for the acqu file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Return dictonary with the parsed metadata information</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.s_read_fid">
<em class="property">static </em><code class="descname">s_read_fid</code><span class="sig-paren">(</span><em>filename</em>, <em>data_type='int32'</em>, <em>selection=slice(None</em>, <em>None</em>, <em>None)</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.s_read_fid" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data from an fid file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; String indicating the name+path to the fid file.</li>
<li><strong>data_type</strong> &#8211; The numpy datatype encoding used for the fid files. (default is &#8216;int32&#8217;).
In the instance of this class this is encoded in the data_type variable associated
with the instance.</li>
<li><strong>selection</strong> (<em>slice or list, i.e., a selection that numpy understands</em>) &#8211; This may be a python slice or a list of indecies to be read. Default value is to
read all (i.e., slice(None,None,None))</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">1D numpy array of intensity values read from the file.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.s_read_spotlist">
<em class="property">static </em><code class="descname">s_read_spotlist</code><span class="sig-paren">(</span><em>spotlist_filename</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.s_read_spotlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the given spotlist file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spotlist_filename</strong> (<em>string</em>) &#8211; Name of the textfile with the spotlist</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>The function returns a number of different items in from of a python dictionary.</dt>
<dd>Most data is stored as 2D spatial maps, indicting for each (x,y) location the corresponding data.
Most data is stored as 2D masked numpy arrays. The masked of the array indicated whether data
has been recorded for a given pixel or not. The dict contains the following keys:</dd>
</dl>
<ul class="simple">
<li>&#8216;spotfolder&#8217; : String indicating the folder where all the spot-data is located</li>
<li>&#8216;fid&#8217; : 2D numpy masked array of strings with fid file name for each (x,y) pixel (intensities).</li>
<li>&#8216;acqu&#8217; : 2D numpy masked array of strings with acqu file name for each (x,y) (metadata).</li>
<li>&#8216;regions&#8217; : 2D numpy masked array of integers with region index for each (x,y) pixel.</li>
<li>&#8216;xpos&#8217; : 2D numpy masked array of integers indicated for each pixel its x position.</li>
<li>&#8216;ypos&#8217; : 2D numpy masked array of integers indicated for each pixel its x position.</li>
<li>&#8216;spotname&#8217; : 2D masked numpy array of strings with spot name for each (x,y) pixel.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.s_spot_from_dir">
<em class="property">static </em><code class="descname">s_spot_from_dir</code><span class="sig-paren">(</span><em>in_dir</em>, <em>spot_folder_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.s_spot_from_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to  s_read_spotlist but instead of using a spotlist file the structure of the data is parsed
directly from the structure of the direcory containint all spots.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param in_dir:</th><td class="field-body"><p class="first">Name of the directory with all spots</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">type in_dir:</th><td class="field-body"><p class="first">string</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param spot_folder_only:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><p class="first">If set to True, then the function only constructs the spot folders but
does not check for acqu files etc. If set to True, only the spotfolder
list will be returned.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">returns:</th><td class="field-body"><dl class="first docutils">
<dt>The function returns None in case that no valid spots were found. Returns a list of strings</dt>
<dd><p class="first last">with the spotfolders if spot_folder_only is set to True. Otherwise, the function returns a
number of different items in from of a python dictionary. Most data is stored as 2D spatial
maps, indicting for each (x,y) location the corresponding data. Most data is stored as 2D
masked numpy arrays. The masked of the array indicated whether data has been recorded for
a given pixel or not. The dict contains the following keys:</p>
</dd>
</dl>
<ul class="last simple">
<li>&#8216;spotfolder&#8217; : String indicating the folder where all the spot-data is located</li>
<li>&#8216;fid&#8217; : 2D numpy masked array of strings with fid file name for each (x,y) pixel (intensities)</li>
<li>&#8216;acqu&#8217; : 2D numpy masked array of strings with acqu file name  for each (x,y) pixel (metadata)</li>
<li>&#8216;regions&#8217; : 2D numpy masked array of integers with the index of the region for each (x,y) pixel.</li>
<li>&#8216;xpos&#8217; : 2D numpy masked array of integers indicated for each pixel its x position.</li>
<li>&#8216;ypos&#8217; : 2D numpy masked array of integers indicated for each pixel its x position.</li>
<li>&#8216;spotname&#8217; : 2D masked numpy array of strings with the name of the spot corresponding to a pixel.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="omsi.dataformat.bruckerflex_file.bruckerflex_file.set_region_selection">
<code class="descname">set_region_selection</code><span class="sig-paren">(</span><em>region_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#omsi.dataformat.bruckerflex_file.bruckerflex_file.set_region_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Define which region should be selected for local data reads.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>region_index</strong> &#8211; The index of the region that should be read. The shape of the
data will be adjusted accordingly. Set to None to select all regions and treat
the data as a single full 3D image.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="omsi.dataformat.omsi_file.html" class="btn btn-neutral float-right" title="OMSI Dataformat Package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="omsi.analysis.compound_stats.html" class="btn btn-neutral" title="compound_stats Package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Oliver Rübel and Ben Bowen.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>